from matplotlib.ticker import FuncFormatter, MultipleLocator
from scipy.ndimage import gaussian_filter1d
from matplotlib import pyplot as plt

esno_c_1i = [-3, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, ]
fer_c_1i = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9836065573770492, 0.9917355371900827, 0.975609756097561, 0.975609756097561, 0.9090909090909091, 0.851063829787234, 0.7692307692307693, 0.631578947368421, 0.5529953917050692, 0.43795620437956206, 0.38095238095238093, 0.31007751937984496, 0.2863961813842482, 0.16597510373443983, 0.11616650532429816, 0.08759124087591241, 0.05542725173210162, 0.031804929764113435, 0.018317814074187148, 0.011661807580174927, 0.008149959250203748, 0.004156563907170073, 0.0024527839097375523, 0.0013832098765432098, ]
ber_c_1i = [0.15013888888888888, 0.14210317460317462, 0.13212301587301586, 0.12623015873015872, 0.11591269841269841, 0.1031547619047619, 0.09476190476190477, 0.08388888888888889, 0.07702380952380952, 0.06867063492063492, 0.06027777777777778, 0.05501984126984127, 0.044861111111111115, 0.042718253968253975, 0.03307539682539683, 0.031031746031746032, 0.022950819672131147, 0.019578905942542305, 0.016144018583042975, 0.012427409988385598, 0.009992784992784992, 0.007750759878419452, 0.006486568986568986, 0.0040977443609022555, 0.0034233048057932852, 0.002076816127911018, 0.001708238851095994, 0.0012735326688815061, 0.001125127855438118, 0.000599354541263255, 0.00039874613930761076, 0.0002867570385818561, 0.00017485978225008247, 8.960912751000215e-05, 5.7424893327808914e-05, 3.3088065158036e-05, 2.1830247991617187e-05, 1.1793425371534136e-05, 6.521290553667301e-06, 3.68163031789048e-06, ]
plt.plot(esno_c_1i, ber_c_1i , label="i = 1-perm_c", linewidth=2)
# GLDPC_LDPC_420_196_from_BCH15_11 моделирования GLDPC с НЕНУЛЕВЫМ кодовым словом 1 ИТЕРАЦИЯ
esno_gldpc_LDPC_420_196_from_BCH15_11_1i = []
fer_gldpc_LDPC_420_196_from_BCH15_11_1i = []
ber_gldpc_LDPC_420_196_from_BCH15_11_1i = []
# plt.plot(esno_gldpc_LDPC_420_196_from_BCH15_11_1i[::4], fer_gldpc_LDPC_420_196_from_BCH15_11_1i[::4], label="i = 1", linewidth=1)
# plt.plot(esno_gldpc_LDPC_420_196_from_BCH15_11_1i, gaussian_filter1d(ber_gldpc_LDPC_420_196_from_BCH15_11_1i, sigma=1).tolist(), label="i = 1", linewidth=2)


#_________________________________________________________________________________
esno_c_2i = [-3, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, ]
fer_c_2i = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9836065573770492, 0.9836065573770492, 0.975609756097561, 0.8823529411764706, 0.851063829787234, 0.7792207792207793, 0.5853658536585366, 0.5240174672489083, 0.40268456375838924, 0.2708803611738149, 0.1602136181575434, 0.1282051282051282, 0.07952286282306163, 0.04709576138147567, 0.02250562640660165, 0.014174344436569808, 0.00632211158526948, 0.003719892123128429, 0.0017717561229807191, 0.0009160149955047412, 0.0004118276912939626, 0.00017677782241864204, ]
ber_c_2i = [0.14740079365079364, 0.13992063492063492, 0.12587301587301586, 0.10793650793650794, 0.09958333333333333, 0.08384920634920635, 0.07053571428571428, 0.062242063492063494, 0.05126984126984127, 0.042369242779078845, 0.03192818110850898, 0.02502903600464576, 0.01903011204481793, 0.014522120905099627, 0.011147186147186147, 0.006933797909407666, 0.004678727386150967, 0.0031639501438159153, 0.001907986670966355, 0.0008900756564307966, 0.0006715506715506716, 0.00038972514121619493, 0.0002205277715481797, 9.600614439324115e-05, 5.28725546443477e-05, 2.471142822020015e-05, 1.4318632378708637e-05, 6.823990669743666e-06, 3.2310934585705157e-06, 1.6473107651758505e-06, 7.844037574853163e-07, ]
plt.plot(esno_c_2i, ber_c_2i , label="i = 2-perm_c", linewidth=2)
# GLDPC_LDPC_420_196_from_BCH15_11 моделирования GLDPC с НЕНУЛЕВЫМ кодовым словом 2 ИТЕРАЦИИ
esno_gldpc_LDPC_420_196_from_BCH15_11_2i = []
fer_gldpc_LDPC_420_196_from_BCH15_11_2i = []
ber_gldpc_LDPC_420_196_from_BCH15_11_2i = []
# plt.plot(esno_gldpc_LDPC_420_196_from_BCH15_11_2i, gaussian_filter1d(ber_gldpc_LDPC_420_196_from_BCH15_11_2i, sigma=1).tolist(), label="i = 2_v2", alpha=1, linewidth=2)
# plt.plot(esno_gldpc_LDPC_420_196_from_BCH15_11_2i[::4], fer_gldpc_LDPC_420_196_from_BCH15_11_2i[::4], label="i = 2_v2", alpha=1, linewidth=1)

#_________________________________________________________________________________
esno_c_3i = [-3, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, ]
fer_c_3i = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9836065573770492, 0.975609756097561, 0.9375, 0.7894736842105263, 0.6976744186046512, 0.6741573033707865, 0.43010752688172044, 0.37383177570093457, 0.23715415019762845, 0.147239263803681, 0.10238907849829351, 0.06147540983606557, 0.031496062992125984, 0.016194331983805668, 0.006650778695338913, 0.00432043204320432, 0.001536176967586666, 0.0008471748004004827,]
ber_c_3i = [0.15081349206349207, 0.131765873015873, 0.12251984126984126, 0.10384920634920634, 0.08906746031746032, 0.07267857142857143, 0.05729898516783763, 0.047173828881145956, 0.03463541666666667, 0.024827694235588973, 0.015503875968992248, 0.01594435527019797, 0.007313534732889571, 0.0050808485387924636, 0.003105590062111801, 0.0013234005258545135, 0.0008329270274662766, 0.00042325331772053083, 0.00021622297212848393, 0.00010796221322537112, 4.4866364214587906e-05, 2.3745231666023744e-05, 8.351438276165606e-06, 4.482406351325305e-06,]
plt.plot(esno_c_3i, ber_c_3i , label="i = 3-perm_c", linewidth=2)
# GLDPC_LDPC_420_196_from_BCH15_11 моделирования GLDPC с НЕНУЛЕВЫМ кодовым словом 3 ИТЕРАЦИИ
esno_gldpc_LDPC_420_196_from_BCH15_11_3i = []
fer_gldpc_LDPC_420_196_from_BCH15_11_3i = []
ber_gldpc_LDPC_420_196_from_BCH15_11_3i = []
# plt.plot(esno_gldpc_LDPC_420_196_from_BCH15_11_3i[::4], fer_gldpc_LDPC_420_196_from_BCH15_11_3i[::4], label="i = 3", alpha=1, linewidth=1)
# plt.plot(esno_gldpc_LDPC_420_196_from_BCH15_11_2, gaussian_filter1d(ber_gldpc_LDPC_420_196_from_BCH15_11_3i, sigma=1).tolist(), label="i = 3", linewidth=2)

#_________________________________________________________________________________
esno_c_4i = [-3, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0,]
fer_c_4i = [1.0, 1.0, 1.0, 1.0, 0.96, 0.9917355371900827, 0.9230769230769231, 0.8275862068965517, 0.7142857142857143, 0.5607476635514018, 0.46875, 0.3333333333333333, 0.22900763358778625, 0.11352885525070956, 0.06749156355455568, 0.03665241295051924, 0.02244668911335578, 0.011275016442732313, 0.005128205128205128, 0.002110446711220542, 0.0010577297778767466,]
ber_c_4i = [0.1484126984126984, 0.13089285714285714, 0.11603174603174603, 0.09498015873015872, 0.07735238095238095, 0.06497441951987407, 0.0476007326007326, 0.03735632183908046, 0.025496031746031746, 0.016911437472185136, 0.012295386904761904, 0.009199735449735449, 0.003980370774263904, 0.0019191782673334233, 0.0008570357276768975, 0.00037743258574046603, 0.00023515579071134627, 9.530073421833263e-05, 4.060182631611203e-05, 1.6205215818300586e-05, 7.290117516694369e-06,]
plt.plot(esno_c_4i, ber_c_4i , label="i = 4-perm_c", linewidth=2)
# GLDPC_LDPC_420_196_from_BCH15_11 моделирования GLDPC с НЕНУЛЕВЫМ кодовым словом 4 ИТЕРАЦИИ
esno_gldpc_LDPC_420_196_from_BCH15_11_4i = []
fer_gldpc_LDPC_420_196_from_BCH15_11_4i = []
ber_gldpc_LDPC_420_196_from_BCH15_11_4i = []
# plt.plot(esno_gldpc_LDPC_420_196_from_BCH15_11_4i[::4], ber_gldpc_LDPC_420_196_from_BCH15_11_4i[::4], label="i = 4", alpha=1, linewidth=1)
# plt.plot(esno_gldpc_LDPC_420_196_from_BCH15_11_2, gaussian_filter1d(fer_gldpc_LDPC_420_196_from_BCH15_11_2, sigma=1).tolist(), label="GLDPC_32_28_from_Ham16_11v4", alpha=1, linewidth=2)

#_________________________________________________________________________________
esno_c_10i = [-3, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0, ]
fer_c_10i = [1.0, 1.0, 0.9917355371900827, 0.8633093525179856, 0.5853658536585366, 0.5357142857142857, 0.40816326530612246, 0.3037974683544304, 0.22900763358778625, 0.13683010262257697, 0.07899934167215274, 0.04728132387706856, 0.02320634306710501, 0.013774716729615642, 0.004597877313307023, 0.002059279483560471,]
ber_c_10i = [0.14462301587301588, 0.13698412698412696, 0.10686737504919322, 0.07552243919150393, 0.05481997677119628, 0.05038265306122449, 0.03654842889536767, 0.024569017480409884, 0.016998364231188657, 0.009336482597600044, 0.0049515658798081445, 0.0025648241960298697, 0.0012049801548931311, 0.0006464171982945589, 0.00017634319140123959, 7.406600348429372e-05,]
plt.plot(esno_c_10i, ber_c_10i , label="i = 10-perm_c", linewidth=2)
# GLDPC_LDPC_420_196_from_BCH15_11 моделирования GLDPC с НЕНУЛЕВЫМ кодовым словом 10 ИТЕРАЦИИ
esno_gldpc_LDPC_420_196_from_BCH15_11_10i = []
fer_gldpc_LDPC_420_196_from_BCH15_11_10i = []
ber_gldpc_LDPC_420_196_from_BCH15_11_10i = []
# plt.plot(esno_gldpc_LDPC_420_196_from_BCH15_11_10i[::4], fer_gldpc_LDPC_420_196_from_BCH15_11_10i[::4], label="i = 10", linewidth=1)

#_________________________________________________________________________________
esno_c_20i = [-3, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, ]
fer_c_20i = [1.0, 1.0, 0.9448818897637795, 0.7272727272727273, 0.5660377358490566, 0.44609665427509293, 0.31413612565445026, 0.24048096192384769, 0.16597510373443983, 0.10498687664041995, 0.06575342465753424, 0.032145727297080096, 0.012696041822255415, 0.007057993177273262,  0.0029773719730051607,]
ber_c_20i = [0.1478769841269841, 0.13005952380952382, 0.10500562429696288, 0.08014430014430014, 0.08551212938005391, 0.06541865816958754, 0.04263275991024682, 0.028700257658173488, 0.017104656523743662, 0.010163312919218431, 0.005539465101108937, 0.002476624188384167, 0.0009065965851804103, 0.0004562488446737359, 0.0001747433788918505,]
plt.plot(esno_c_20i, ber_c_20i , label="i = 20-perm_c", linewidth=2)


plt.yscale("log")  # Логарифмическая шкала по Y
plt.xlabel("EsNo [dB]")
plt.ylabel("BER")
plt.title("GLDPC на основе LDPC(420,364)_perm и BCJR(15,11)")
plt.legend(
    # loc='lower right',
    # bbox_to_anchor=(0.5, -0.1),  
    # ncol=2,                
    fontsize=8,
    # frameon=False     
)
plt.grid(True, which="both", linestyle="--")
plt.savefig('../modeling_results/gldpc_420_196_perm_classic_compare_iter_10_20_BER_COMPLEX_AWGN.png', dpi=300, bbox_inches='tight')

# RESULTS
# [3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4.0]
# [0.0042158516020236085, 0.002476361999099505, 0, 0, 0, 0, 0, 0, 0, 0]
# [1.0037741909580021e-05, 5.896099997855964e-06, 0, 0, 0, 0, 0, 0, 0, 0]
