from scipy.ndimage import gaussian_filter1d
from matplotlib import pyplot as plt

# GLDPC_LDPC_420_196_from_BCH15_11 моделирования GLDPC с НУЛЕВЫМ кодовым словом
esno_gldpc_LDPC_420_196_from_BCH15_11 = [0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0]
fer_gldpc_LDPC_420_196_from_BCH15_11 = [1.0, 0.967741935483871, 0.9375, 0.9375, 0.8333333333333334, 0.8333333333333334, 0.7317073170731707, 0.7692307692307693, 0.4411764705882353, 0.3157894736842105, 0.37037037037037035, 0.22388059701492538, 0.1935483870967742, 0.18518518518518517, 0.14925373134328357, 0.11494252873563218, 0.1048951048951049, 0.09868421052631579, 0.05905511811023622, 0.04862236628849271, 0.0398936170212766, 0.03541912632821724, 0.029615004935834157, 0.03500583430571762, 0.031023784901758014, 0.026761819803746655, 0.017391304347826087, 0.019280205655526992, 0.014932802389248382, 0.010046885465505693, 0.008438818565400843]
ber_gldpc_LDPC_420_196_from_BCH15_11 = [0.0023809523809523807, 0.002304147465437788, 0.002232142857142857, 0.002306547619047619, 0.0021164021164021165, 0.001984126984126984, 0.0021486643437862952, 0.002564102564102564, 0.0014355742296918769, 0.0013533834586466164, 0.0012933568489124044, 0.0007995735607675906, 0.0008602150537634409, 0.0008818342151675485, 0.0008173418621179816, 0.0005838350665936874, 0.0005994005994005994, 0.0005639097744360903, 0.0003187101612298463, 0.00026240642123948445, 0.00020896656534954408, 0.00018552875695732838, 0.00015042542189630049, 0.00017225093071067402, 0.00015758112965972326, 0.00013168514506605496, 8.557625948930297e-05, 0.00010099155343371282, 7.110858280594467e-05, 4.78423117405033e-05, 4.018485031143259e-05]
plt.plot(esno_gldpc_LDPC_420_196_from_BCH15_11, ber_gldpc_LDPC_420_196_from_BCH15_11, label="gldpc-decoder", alpha=1, linewidth=2)
# plt.plot(esno_gldpc_LDPC_420_196_from_BCH15_11, fer_gldpc_LDPC_420_196_from_BCH15_11, label="gldpc-decoder", alpha=1, linewidth=2)
# plt.plot(esno_gldpc_LDPC_420_196_from_BCH15_11, gaussian_filter1d(fer_gldpc_LDPC_420_196_from_BCH15_11, sigma=1).tolist(), label="GLDPC_32_28_from_Ham16_11v4", alpha=1, linewidth=2)

# sp декодирование полной матрицы 
esno_gldpc_LDPC_420_196_from_BCH15_11_full = [0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, ]
fer_gldpc_LDPC_420_196_from_BCH15_11_full = [1.0, 1.0, 1.0, 0.967741935483871, 0.9090909090909091, 0.9090909090909091, 0.8823529411764706, 0.7692307692307693, 0.625, 0.5660377358490566, 0.5769230769230769, 0.4166666666666667, 0.23255813953488372, 0.20408163265306123, 0.16393442622950818, 0.13392857142857142, 0.0683371298405467, 0.08928571428571429, 0.050505050505050504, 0.03937007874015748, 0.0264783759929391, 0.033783783783783786, 0.01654715940430226, 0.018072289156626505, 0.009057971014492754, 0.007383706620723603, 0.007048872180451127, 0.007890583903208837, 0.004786215698787492,]
ber_gldpc_LDPC_420_196_from_BCH15_11_full = [0.0023809523809523807, 0.0023809523809523807, 0.0023809523809523807, 0.002304147465437788, 0.0021645021645021645, 0.0021645021645021645, 0.0021008403361344537, 0.0018315018315018315, 0.001488095238095238, 0.001347708894878706, 0.0013736263736263735, 0.000992063492063492, 0.0005537098560354374, 0.00048590864917395527, 0.00039032006245121, 0.00031887755102040814, 0.00016270745200130165, 0.00021258503401360543, 0.00012025012025012024, 9.373828271466066e-05, 6.304375236414071e-05, 8.043758043758043e-05, 3.939799858167205e-05, 4.302925989672977e-05, 2.1566597653554176e-05, 1.758025385886572e-05, 1.6783029001074113e-05, 1.8787104531449612e-05, 1.1395751663779742e-05,]
plt.plot(esno_gldpc_LDPC_420_196_from_BCH15_11_full, ber_gldpc_LDPC_420_196_from_BCH15_11_full, label="SP", alpha=1, linewidth=2)
# plt.plot(esno_gldpc_LDPC_420_196_from_BCH15_11_full, gaussian_filter1d(fer_gldpc_LDPC_420_196_from_BCH15_11_full, sigma=1).tolist(), label="GLDPC_32_28_from_Ham16_11v4", alpha=1, linewidth=2)

plt.yscale("log")  # Логарифмическая шкала по Y
plt.xlabel("EsNo [dB]")
plt.ylabel("BER")
plt.title("GLDPC на основе LDPC(420,364) и BCJR(15,11)")
plt.legend(
    # loc='lower right',
    # bbox_to_anchor=(0.5, -0.1),  
    # ncol=2,                
    fontsize=8,
    # frameon=False     
)
plt.grid(True, which="both", linestyle="--")
plt.savefig('../modeling_results/gldpc_420_196_norm_BER.png', dpi=300, bbox_inches='tight')