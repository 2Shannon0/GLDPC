from scipy.ndimage import gaussian_filter1d
from matplotlib import pyplot as plt


esno_ldpc_32_28 = [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4.0, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5.0, 5.1, 5.2, 5.3, 5.4, 5.5, 5.6, 5.7, 5.8, 5.9, 6.0, 6.1, 6.2, 6.3, 6.4, 6.5, 6.6, 6.7, 6.8, 6.9, 7.0, 7.1, 7.2, 7.3, 7.4, 7.5, 7.6, 7.7, 7.8, 7.9, 8.0, 8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8, 8.9, 9.0, 9.1, 9.2, 9.3, 9.4, 9.5, 9.6, 9.7, 9.8, 9.9, ] # 10.0
fer_ldpc_32_28 = [1.0, 1.0, 1.0, 1.0, 0.9803921568627451, 1.0, 0.9803921568627451, 1.0, 1.0, 1.0, 0.9803921568627451, 0.9433962264150944, 0.9803921568627451, 0.9433962264150944, 0.9615384615384616, 0.9615384615384616, 0.9433962264150944, 0.9433962264150944, 0.9090909090909091, 0.9433962264150944, 0.9615384615384616, 0.819672131147541, 0.9433962264150944, 0.9615384615384616, 0.9433962264150944, 0.9433962264150944, 0.9259259259259259, 0.9259259259259259, 0.9090909090909091, 0.8333333333333334, 0.9259259259259259, 0.7936507936507936, 0.7246376811594203, 0.7692307692307693, 0.78125, 0.7692307692307693, 0.7936507936507936, 0.746268656716418, 0.684931506849315, 0.684931506849315, 0.6666666666666666, 0.5555555555555556, 0.5555555555555556, 0.5747126436781609, 0.5376344086021505, 0.5208333333333334, 0.4854368932038835, 0.43478260869565216, 0.43103448275862066, 0.3597122302158273, 0.3816793893129771, 0.4032258064516129, 0.32679738562091504, 0.352112676056338, 0.3125, 0.25, 0.26881720430107525, 0.29069767441860467, 0.25, 0.2183406113537118, 0.19157088122605365, 0.1968503937007874, 0.17301038062283736, 0.1519756838905775, 0.14619883040935672, 0.15625, 0.09823182711198428, 0.09090909090909091, 0.09090909090909091, 0.11210762331838565, 0.076103500761035, 0.0794912559618442, 0.07429420505200594, 0.0657030223390276, 0.03915426781519186, 0.0395882818685669, 0.04892367906066536, 0.03219575016097875, 0.029394473838918283, 0.02399232245681382, 0.019105846388995033, 0.016339869281045753, 0.01924557351809084, 0.016523463317911435, 0.01100594320933304, 0.011834319526627219, 0.008180628272251309, 0.006700616456714018, 0.006544502617801047, 0.006150818058801821, 0.0053803938448294415, 0.004, 0.0037017842600133265, 0.002734631371691096, 0.0025135732957973053, 0.0018253504672897196, 0.0012185908215739318, 0.0009976057462090981, 0.0009575242253629017, 0.000563551728413151, ] # 0.0008907575001781516
ber_ldpc_32_28 = [0.054375, 0.044375, 0.04875, 0.05375, 0.04718137254901961, 0.043125, 0.05024509803921569, 0.0425, 0.04, 0.05875, 0.04779411764705882, 0.04716981132075472, 0.034926470588235295, 0.03773584905660377, 0.046274038461538464, 0.045072115384615384, 0.039504716981132074, 0.04540094339622641, 0.042045454545454546, 0.041273584905660375, 0.05228365384615385, 0.04456967213114754, 0.03714622641509434, 0.043870192307692304, 0.04540094339622641, 0.03891509433962264, 0.059027777777777776, 0.045717592592592594, 0.05568181818181818, 0.04739583333333333, 0.04224537037037037, 0.047619047619047616, 0.04483695652173913, 0.03365384615384615, 0.04931640625, 0.0375, 0.04662698412698413, 0.037779850746268655, 0.04280821917808219, 0.03595890410958904, 0.03916666666666667, 0.03229166666666667, 0.03125, 0.031609195402298854, 0.03528225806451613, 0.02734375, 0.02821601941747573, 0.028532608695652172, 0.02478448275862069, 0.022482014388489208, 0.024093511450381678, 0.028981854838709676, 0.018995098039215685, 0.02222711267605634, 0.019921875, 0.01625, 0.021001344086021504, 0.018168604651162792, 0.0175, 0.012827510917030568, 0.011015325670498084, 0.012549212598425197, 0.01189446366782007, 0.008548632218844984, 0.00941154970760234, 0.011328125, 0.006507858546168959, 0.005965909090909091, 0.0057954545454545455, 0.0075672645739910315, 0.004613774733637747, 0.005216613672496025, 0.004457652303120356, 0.004311760840998686, 0.0023981989036805013, 0.0025237529691211403, 0.0029048434442270057, 0.0019518673535093367, 0.0018738977072310405, 0.0015894913627639156, 0.001253821169277799, 0.0010518790849673202, 0.0011306774441878368, 0.0010017349636483807, 0.0006741140215716487, 0.0007544378698224853, 0.0004908376963350785, 0.00042297641383007235, 0.0003967604712041885, 0.00038058186738836264, 0.0003329118691488217, 0.0002325, 0.0002244206707633079, 0.00016407788230146577, 0.00016024029760707822, 0.00011636609228971963, 7.387706855791962e-05, 6.172685554668795e-05, 5.9845264085181356e-05, 3.416532353504728e-05, ] # 5.177527969785506e-05
plt.plot(esno_ldpc_32_28, fer_ldpc_32_28, label="LDPC(32,28)", alpha=1, linewidth=2)
# plt.plot(esno_ldpc_32_28, gaussian_filter1d(fer_ldpc_32_28, sigma=1).tolist(), label="LDPC(32,28)", alpha=1, linewidth=2)

esno_gldpc_matrix_by_sp = [2, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4, 6.6, 6.8, 7.0, 7.2, 7.4, 7.6, 7.8, 8.0]
fer_gldpc_matrix_by_sp = [0.3546099290780142, 0.35714285714285715, 0.3401360544217687, 0.26455026455026454, 0.21739130434782608, 0.15527950310559005, 0.2358490566037736, 0.11547344110854503, 0.12531328320802004, 0.08620689655172414, 0.1006036217303823, 0.06925207756232687, 0.08503401360544217, 0.04382120946538125, 0.04460303300624442, 0.03692762186115214, 0.03546099290780142, 0.02844141069397042, 0.020366598778004074, 0.019952114924181964, 0.013099292638197537, 0.012254901960784314, 0.008742787200559538, 0.0073551044424830835, 0.005460303592879764, 0.00450815976918222, 0.00406934158053227, 0.002743183189773413, 0.0025040064102564105, 0.0015561295944726277, 0.0015502433882119493]
ber_gldpc_matrix_by_sp = [0.011081560283687944, 0.013169642857142857, 0.012542517006802721, 0.008763227513227513, 0.007201086956521739, 0.005725931677018634, 0.008254716981132075, 0.0040415704387990765, 0.004151002506265664, 0.003556034482758621, 0.003709758551307847, 0.0024238227146814403, 0.002816751700680272, 0.0015337423312883436, 0.0018119982158786797, 0.0016386632200886262, 0.0017065602836879433, 0.0011554323094425483, 0.0008655804480651731, 0.0008853750997605746, 0.0004584752423369138, 0.0004978553921568627, 0.0003059975520195838, 0.00027121947631656367, 0.00021158676422409085, 0.00019159679019024433, 0.00016531700170912346, 0.00011658528556537005, 0.00012050530849358975, 6.613550776508668e-05, 6.007193129321303e-05]
# plt.plot(esno_gldpc_matrix_by_sp, fer_gldpc_matrix_by_sp, label="GLDPC_matrix_decoding_sp", alpha=1, linewidth=2)
# plt.plot(esno_ldpc_32_28, gaussian_filter1d(fer_ldpc_32_28, sigma=1).tolist(), label="LDPC(32,28)", alpha=1, linewidth=2)

esno_gldpc_32_28_cc_Ham16_11 = [2, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4, 6.6, 6.8, 7.0, 7.2, 7.4, 7.6, 7.8, 8.0]
fer_gldpc_32_28_cc_Ham16_11 = [0.6578947368421053, 0.6944444444444444, 0.78125, 0.5555555555555556, 0.6024096385542169, 0.5952380952380952, 0.5319148936170213, 0.44642857142857145, 0.390625, 0.43478260869565216, 0.42016806722689076, 0.3937007874015748, 0.36496350364963503, 0.36496350364963503, 0.23148148148148148, 0.2, 0.22727272727272727, 0.12562814070351758, 0.13736263736263737, 0.12376237623762376, 0.13297872340425532, 0.07429420505200594, 0.052576235541535225, 0.06313131313131314, 0.0395882818685669, 0.03259452411994785, 0.02675227394328518, 0.02147766323024055, 0.018839487565938208, 0.013412017167381975, 0.0070028011204481795]
ber_gldpc_32_28_cc_Ham16_11 = [0.0884046052631579, 0.09505208333333333, 0.1171875, 0.07256944444444445, 0.0677710843373494, 0.07961309523809523, 0.07712765957446809, 0.05552455357142857, 0.049072265625, 0.05326086956521739, 0.048581932773109245, 0.05093503937007874, 0.04698905109489051, 0.045848540145985404, 0.028645833333333332, 0.022, 0.02784090909090909, 0.014761306532663316, 0.015625, 0.014619430693069308, 0.014876994680851064, 0.007661589895988113, 0.005224763406940063, 0.006352588383838384, 0.004280482977038797, 0.0031779661016949155, 0.002959470304975923, 0.0022014604810996563, 0.0021547663903541824, 0.0016597371244635192, 0.0007265406162464986]
# plt.plot(esno_gldpc_32_28_cc_Ham16_11, fer_gldpc_32_28_cc_Ham16_11, label="gldpc_32_28_cc_Ham16_11", alpha=1, linewidth=2)
# plt.plot(esno_gldpc_32_28_cc_Ham16_11, gaussian_filter1d(fer_gldpc_32_28_cc_Ham16_11, sigma=1).tolist(), label="LDPC(32,28)", alpha=1, linewidth=2)

esno_gldpc_32_28_cc_Ham16_11_v2 = [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4.0, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5.0, 5.1, 5.2, 5.3, 5.4, 5.5, 5.6, 5.7, 5.8, 5.9, 6.0, 6.1, 6.2, 6.3, 6.4, 6.5, 6.6, 6.7, 6.8, 6.9, 7.0, 7.1, 7.2, 7.3, 7.4, 7.5, 7.6, 7.7, 7.8, 7.9, 8.0, 8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8, 8.9, 9.0, 9.1, 9.2, 9.3, 9.4, 9.5, 9.6, 9.7, 9.8, 9.9, 10.0]
fer_gldpc_32_28_cc_Ham16_11_v2 = [0.9090909090909091, 0.9259259259259259, 0.9615384615384616, 0.9259259259259259, 0.8928571428571429, 0.9433962264150944, 0.8771929824561403, 0.9259259259259259, 0.8771929824561403, 0.8928571428571429, 0.9259259259259259, 0.78125, 0.819672131147541, 0.7936507936507936, 0.8620689655172413, 0.6410256410256411, 0.8333333333333334, 0.6756756756756757, 0.704225352112676, 0.7936507936507936, 0.7142857142857143, 0.684931506849315, 0.78125, 0.7142857142857143, 0.5813953488372093, 0.6578947368421053, 0.5882352941176471, 0.6410256410256411, 0.5813953488372093, 0.5681818181818182, 0.49504950495049505, 0.5102040816326531, 0.45045045045045046, 0.4807692307692308, 0.43478260869565216, 0.6172839506172839, 0.43859649122807015, 0.3968253968253968, 0.4032258064516129, 0.3401360544217687, 0.3105590062111801, 0.352112676056338, 0.29069767441860467, 0.352112676056338, 0.24875621890547264, 0.22624434389140272, 0.25773195876288657, 0.25125628140703515, 0.20080321285140562, 0.22935779816513763, 0.2702702702702703, 0.18726591760299627, 0.17921146953405018, 0.11764705882352941, 0.12886597938144329, 0.09615384615384616, 0.09505703422053231, 0.078125, 0.08130081300813008, 0.0748502994011976, 0.09900990099009901, 0.08077544426494346, 0.07451564828614009, 0.0702247191011236, 0.07342143906020558, 0.049800796812749, 0.05005005005005005, 0.03387533875338753, 0.036337209302325583, 0.030864197530864196, 0.03280839895013123, 0.024838549428713365, 0.028604118993135013, 0.021431633090441493, 0.014334862385321102, 0.017674089784376106, 0.014425851125216388, 0.015552099533437015, 0.009288500835965075, 0.006615506747816882, 0.0074827895839568994, 0.007178750897343862, 0.006915629322268326, 0.0050776886361328325, 0.004899559039686428, 0.003439499208915182, 0.003983111606787222, 0.002762278327164245, 0.0018859384429692214, 0.001965872454195172, 0.001438517751309051, 0.001374608236652554, 0.0011133625776570397, 0.0008370722560771445, 0.0006047484851050448, 0.0005154851746463772, 0.0003779889476031721, 0.00041072147334006914, 0.00035631823494199137, 0.00022323122736993433, 0.00017012010479398456]
ber_gldpc_32_28_cc_Ham16_11_v2 = [0.09375, 0.0798611111111111, 0.0673076923076923, 0.05787037037037037, 0.07087053571428571, 0.06308962264150944, 0.08607456140350878, 0.07465277777777778, 0.06414473684210527, 0.05970982142857143, 0.08275462962962964, 0.064453125, 0.06147540983606557, 0.05555555555555555, 0.06303879310344827, 0.06009615384615385, 0.06979166666666667, 0.05320945945945946, 0.05501760563380282, 0.06101190476190476, 0.054464285714285715, 0.06720890410958905, 0.06103515625, 0.04285714285714286, 0.057412790697674417, 0.06949013157894737, 0.054044117647058826, 0.057291666666666664, 0.051962209302325583, 0.052201704545454544, 0.04733910891089109, 0.045599489795918366, 0.05152027027027027, 0.04326923076923077, 0.04782608695652174, 0.05941358024691358, 0.03892543859649123, 0.03521825396825397, 0.03881048387096774, 0.03741496598639456, 0.0343555900621118, 0.034991197183098594, 0.02525436046511628, 0.029049295774647887, 0.026274875621890546, 0.02531108597285068, 0.02851159793814433, 0.025282663316582913, 0.021460843373493976, 0.02236238532110092, 0.03125, 0.01977996254681648, 0.01881720430107527, 0.011764705882352941, 0.01401417525773196, 0.010516826923076924, 0.009565114068441065, 0.008935546875, 0.008079268292682927, 0.008514221556886227, 0.010581683168316832, 0.008531906300484653, 0.008988450074515649, 0.00741748595505618, 0.007755139500734215, 0.005011205179282868, 0.005286536536536536, 0.003662771002710027, 0.004269622093023256, 0.0033179012345679014, 0.0032193241469816274, 0.002856433184302037, 0.003092820366132723, 0.00237087441063009, 0.0014782826834862386, 0.001690084835630965, 0.00148766589728794, 0.0013705287713841369, 0.000981097900798811, 0.0007731873511510982, 0.0006547440885962286, 0.0006864680545585068, 0.0007002074688796681, 0.0005363308621915304, 0.0004991425771680548, 0.0003052555547912224, 0.0004978889508484028, 0.0002555107452626927, 0.00018977255582377793, 0.00021993198081308484, 0.0001483471431037459, 0.00014003821410897894, 0.00011759892226502483, 8.056820464742516e-05, 6.463249434560166e-05, 4.96154480597138e-05, 3.9216353313829106e-05, 4.184225009651955e-05, 3.29594367321342e-05, 2.2323122736993433e-05, 1.7543635806879657e-05]
plt.plot(esno_gldpc_32_28_cc_Ham16_11_v2, fer_gldpc_32_28_cc_Ham16_11_v2, label="GLDPC_32_28_from_Ham16_11", alpha=1, linewidth=2)
# plt.plot(esno_gldpc_32_28_cc_Ham16_11_v2, gaussian_filter1d(fer_gldpc_32_28_cc_Ham16_11_v2, sigma=1).tolist(), label="GLDPC_32_28_from_Ham16_11", alpha=1, linewidth=2)

plt.yscale("log")  # Логарифмическая шкала по Y
plt.xlabel("EsNo [dB]")
plt.ylabel("FER")
# plt.title("LDPC(32,28)")
plt.legend()
plt.grid(True, which="both", linestyle="--")
plt.savefig('modeling_results/GLDPC(32,28)_LDPC_real.png', dpi=300, bbox_inches='tight')