from matplotlib.ticker import FuncFormatter, MultipleLocator
from scipy.ndimage import gaussian_filter1d
from matplotlib import pyplot as plt
# ldpc 420 224 <- bch15 11 до 20 итераций
# esno=[-1, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1, -0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]

# fer_py=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9836065573770492, 1.0, 1.0, 0.975609756097561, 0.9523809523809523, 0.9836065573770492, 0.967741935483871, 0.9302325581395349, 0.8633093525179856, 0.9090909090909091, 0.8633093525179856, 0.7947019867549668, 0.7947019867549668]
# ber_py=[0.22642857142857142, 0.2222420634920635, 0.21386904761904763, 0.20720238095238094, 0.20521825396825397, 0.19343253968253968, 0.1928968253968254, 0.1875, 0.18659250585480094, 0.17424603174603173, 0.17160714285714285, 0.16045296167247386, 0.15461073318216176, 0.13436768149882902, 0.1377304147465438, 0.12914359542266518, 0.1169921205892429, 0.11713564213564213, 0.09753340184994862, 0.09200567644276253, 0.08771680857773573]
# plt.plot(esno, ber_py, label="py ber")
# plt.plot(esno, fer_py, label="py fer")


# fer_cpp=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 0.9836065573770492, 0.9836065573770492, 0.9917355371900827, 0.967741935483871]
# ber_cpp=[0.19666666666666668, 0.19448412698412698, 0.1839484126984127, 0.18327380952380953, 0.17888888888888888, 0.1771825396825397, 0.17259920634920636, 0.16553571428571429, 0.1555952380952381, 0.15527777777777776, 0.14113095238095238, 0.14011904761904762, 0.1334126984126984, 0.12946428571428573, 0.12311507936507936, 0.11287698412698413, 0.10236127508854782, 0.09822404371584699, 0.08830991412958626, 0.08573396300669027, 0.0762288786482335]
# plt.plot(esno, ber_cpp, label="cpp ber")
# plt.plot(esno, fer_cpp, label="cpp fer")

# ldpc 420 224 <- bch15 11 4 итерации
esno=[-1, -0.95, -0.9, -0.85, -0.8, -0.75, -0.7, -0.65, -0.6, -0.55, -0.5, -0.45, -0.4, -0.35, -0.3, -0.25, -0.2, -0.15, -0.1, -0.05, -0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0, 1.05, 1.1, 1.15, 1.2, 1.25, 1.3, 1.35, 1.4, 1.45, 1.5, 1.55, 1.6, 1.65, 1.7, 1.75, 1.8, 1.85, 1.9, 1.95, 2.0, 2.05, 2.1, 2.15, 2.2, 2.25, 2.3, 2.35, 2.4, 2.45, 2.5, 2.55, 2.6, 2.65, 2.7, 2.75, 2.8, 2.85, 2.9, 2.95, 3.0] # 

fer_py=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 0.9917355371900827, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 1.0, 0.9917355371900827, 1.0, 0.9917355371900827, 1.0, 0.967741935483871, 0.9917355371900827, 0.9836065573770492, 0.9917355371900827, 0.9917355371900827, 0.9523809523809523, 0.96, 0.9836065573770492, 0.967741935483871, 0.9917355371900827, 0.9523809523809523, 0.9375, 0.9302325581395349, 0.8955223880597015, 0.8955223880597015, 0.9448818897637795, 0.8275862068965517, 0.9090909090909091, 0.8275862068965517, 0.8, 0.8275862068965517, 0.7692307692307693, 0.6936416184971098, 0.7547169811320755, 0.6818181818181818, 0.6557377049180327, 0.631578947368421, 0.5607476635514018, 0.6282722513089005, 0.594059405940594, 0.5286343612334802, 0.49586776859504134, 0.5172413793103449, 0.43956043956043955, 0.40540540540540543, 0.425531914893617, 0.3157894736842105, 0.3519061583577713, 0.2733485193621868, 0.2569593147751606, 0.21660649819494585, 0.21621621621621623, 0.20797227036395147, 0.20270270270270271, 0.1938610662358643, 0.13856812933025403, 0.14634146341463414]
ber_py=[0.19807539682539682, 0.19843253968253968, 0.19650793650793652, 0.1863293650793651, 0.19027777777777777, 0.18896825396825398, 0.18910714285714286, 0.1893253968253968, 0.18662698412698414, 0.17817460317460315, 0.17972222222222223, 0.17569444444444443, 0.17015873015873015, 0.16781746031746034, 0.16638888888888886, 0.1640873015873016, 0.16561507936507935, 0.15944444444444444, 0.1514484126984127, 0.1555686737504919, 0.14547422274695002, 0.1334126984126984, 0.13996031746031745, 0.13825396825396827, 0.13371031746031745, 0.13234126984126984, 0.11952380952380953, 0.11918536009445099, 0.12716269841269842, 0.11890873015873016, 0.10775285320739866, 0.10759920634920635, 0.10403384494293585, 0.10823412698412697, 0.09951996927803379, 0.09742227469500196, 0.08629976580796253, 0.08353010625737899, 0.08358913813459268, 0.08223733938019653, 0.0745904761904762, 0.07730288836846214, 0.06582181259600614, 0.0649547422274695, 0.05958049886621315, 0.05466889880952381, 0.05939461055740126, 0.05216773276474769, 0.04557569296375266, 0.045556805399325086, 0.035632183908045977, 0.037770562770562774, 0.03799671592775041, 0.03296825396825397, 0.03157635467980295, 0.028098290598290603, 0.024346270300027527, 0.026205450733752623, 0.021347402597402598, 0.01916471506635441, 0.01893483709273183, 0.014463729417000446, 0.014385440039890302, 0.01452145214521452, 0.013436123348017621, 0.0108913813459268, 0.009831691297208537, 0.009009244723530438, 0.008108108108108109, 0.007776089159067883, 0.00606516290726817, 0.005481078061723223, 0.004159887189499945, 0.003767716936881819, 0.0030556988138215574, 0.002672672672672673, 0.002628538417099942, 0.002376930501930502, 0.0027579044541887836, 0.0015808863961288904, 0.0015708478513356563]
plt.plot(esno, ber_py, label="py ber")
plt.plot(esno, fer_py, label="py fer")


fer_cpp=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9836065573770492, 0.967741935483871, 0.9917355371900827, 1.0, 1.0, 0.9836065573770492, 0.975609756097561, 0.9836065573770492, 0.96, 0.9917355371900827, 0.96, 0.9302325581395349, 0.96, 0.9090909090909091, 0.9230769230769231, 0.9090909090909091, 0.8759124087591241, 0.8759124087591241, 0.851063829787234, 0.8823529411764706, 0.8633093525179856, 0.8391608391608392, 0.8695652173913043, 0.7741935483870968, 0.8571428571428571, 0.7741935483870968, 0.7692307692307693, 0.7643312101910829, 0.7643312101910829, 0.7058823529411765, 0.718562874251497, 0.6666666666666666, 0.6, 0.5555555555555556, 0.5194805194805194, 0.45627376425855515, 0.44280442804428044, 0.4013377926421405, 0.35294117647058826, 0.3448275862068966, 0.3342618384401114, 0.23166023166023167, 0.26200873362445415, 0.2037351443123939, 0.21818181818181817, 0.18633540372670807, 0.16371077762619374, 0.14869888475836432, 0.1340782122905028,]
ber_cpp=[0.2019047619047619, 0.20444444444444446, 0.19496031746031747, 0.18658730158730158, 0.1925, 0.18468253968253967, 0.1918452380952381, 0.1861111111111111, 0.17942460317460318, 0.17888888888888888, 0.1740079365079365, 0.1758531746031746, 0.1673611111111111, 0.16660714285714287, 0.16537698412698412, 0.16208333333333333, 0.1555753968253968, 0.1584325396825397, 0.1545436507936508, 0.1532738095238095, 0.14779761904761904, 0.13855158730158731, 0.13793650793650794, 0.13974813065722155, 0.1332142857142857, 0.13232142857142856, 0.1338888888888889, 0.1256547619047619, 0.11390873015873017, 0.11630952380952381, 0.1113888888888889, 0.11192460317460316, 0.10023419203747072, 0.09903993855606759, 0.09295552931916568, 0.09869047619047619, 0.09148809523809523, 0.0907103825136612, 0.08579171506000774, 0.07550741608118658, 0.07836190476190477, 0.06759149940968123, 0.06916190476190477, 0.06775562938353637, 0.0691047619047619, 0.05907287157287157, 0.05575091575091575, 0.05061327561327562, 0.04907890163364616, 0.043917274939172746, 0.04375211077338737, 0.03949579831932773, 0.03860911270983213, 0.035814185814185814, 0.03668046928916494, 0.03422427035330261, 0.0341156462585034, 0.034086021505376346, 0.035897435897435895, 0.0345920533818623, 0.02870791628753412, 0.029397759103641456, 0.029726261762189905, 0.025595238095238095, 0.020607142857142855, 0.017184744268077604, 0.016079158936301793, 0.011126199529241354, 0.011711474257599719, 0.009945851250199077, 0.00773109243697479, 0.006096059113300492, 0.005823053455365434, 0.0037277072991358704, 0.004174464545643585, 0.0031207049882771443, 0.0027445887445887445, 0.002580597456373854, 0.0018547391671539012, 0.0017672744438543696, 0.001628092577813248,]
plt.plot(esno, ber_cpp, label="cpp ber?")
plt.plot(esno, fer_cpp, label="cpp fer?")

#ldpc 420 224 <- bch15 11 4 итерации
# esno=[-1, -0.95, -0.9, -0.85, -0.8, -0.75, -0.7, -0.65, -0.6, -0.55, -0.5, -0.45, -0.4, -0.35, -0.3, -0.25, -0.2, -0.15, -0.1, -0.05, 0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0, 1.05, 1.1, 1.15, 1.2, 1.25, 1.3, 1.35, 1.4, 1.45, 1.5, 1.55, 1.6, 1.65, 1.7, 1.75, 1.8, 1.85, 1.9, 1.95, 2.0, 2.05, 2.1, 2.15, 2.2, 2.25, 2.3, 2.35, 2.4, 2.45, 2.5, 2.55, 2.6, 2.65, 2.7, 2.75, 2.8, 2.85, 2.9, 2.95, 3.0]

# fer_py=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 0.9917355371900827, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 1.0, 0.9917355371900827, 1.0, 0.9917355371900827, 1.0, 0.967741935483871, 0.9917355371900827, 0.9836065573770492, 0.9917355371900827, 0.9917355371900827, 0.9523809523809523, 0.96, 0.9836065573770492, 0.967741935483871, 0.9917355371900827, 0.9523809523809523, 0.9375, 0.9302325581395349, 0.8955223880597015, 0.8955223880597015, 0.9448818897637795, 0.8275862068965517, 0.9090909090909091, 0.8275862068965517, 0.8, 0.8275862068965517, 0.7692307692307693, 0.6936416184971098, 0.7547169811320755, 0.6818181818181818, 0.6557377049180327, 0.631578947368421, 0.5607476635514018, 0.6282722513089005, 0.594059405940594, 0.5286343612334802, 0.49586776859504134, 0.5172413793103449, 0.43956043956043955, 0.40540540540540543, 0.425531914893617, 0.3157894736842105, 0.3519061583577713, 0.2733485193621868, 0.2569593147751606, 0.21660649819494585, 0.21621621621621623, 0.20797227036395147, 0.20270270270270271, 0.1938610662358643, 0.13856812933025403, 0.14634146341463414]
# ber_py=[0.19807539682539682, 0.19843253968253968, 0.19650793650793652, 0.1863293650793651, 0.19027777777777777, 0.18896825396825398, 0.18910714285714286, 0.1893253968253968, 0.18662698412698414, 0.17817460317460315, 0.17972222222222223, 0.17569444444444443, 0.17015873015873015, 0.16781746031746034, 0.16638888888888886, 0.1640873015873016, 0.16561507936507935, 0.15944444444444444, 0.1514484126984127, 0.1555686737504919, 0.14547422274695002, 0.1334126984126984, 0.13996031746031745, 0.13825396825396827, 0.13371031746031745, 0.13234126984126984, 0.11952380952380953, 0.11918536009445099, 0.12716269841269842, 0.11890873015873016, 0.10775285320739866, 0.10759920634920635, 0.10403384494293585, 0.10823412698412697, 0.09951996927803379, 0.09742227469500196, 0.08629976580796253, 0.08353010625737899, 0.08358913813459268, 0.08223733938019653, 0.0745904761904762, 0.07730288836846214, 0.06582181259600614, 0.0649547422274695, 0.05958049886621315, 0.05466889880952381, 0.05939461055740126, 0.05216773276474769, 0.04557569296375266, 0.045556805399325086, 0.035632183908045977, 0.037770562770562774, 0.03799671592775041, 0.03296825396825397, 0.03157635467980295, 0.028098290598290603, 0.024346270300027527, 0.026205450733752623, 0.021347402597402598, 0.01916471506635441, 0.01893483709273183, 0.014463729417000446, 0.014385440039890302, 0.01452145214521452, 0.013436123348017621, 0.0108913813459268, 0.009831691297208537, 0.009009244723530438, 0.008108108108108109, 0.007776089159067883, 0.00606516290726817, 0.005481078061723223, 0.004159887189499945, 0.003767716936881819, 0.0030556988138215574, 0.002672672672672673, 0.002628538417099942, 0.002376930501930502, 0.0027579044541887836, 0.0015808863961288904, 0.0015708478513356563]
# plt.plot(esno, ber_py, label="py ber")
# plt.plot(esno, fer_py, label="py fer")


fer_cpp=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 0.9917355371900827, 1.0, 0.9917355371900827, 1.0, 0.9917355371900827, 0.9917355371900827, 0.9836065573770492, 0.967741935483871, 0.9836065573770492, 1.0, 0.9836065573770492, 0.9448818897637795, 0.9917355371900827, 0.9302325581395349, 0.9448818897637795, 0.967741935483871, 0.9230769230769231, 0.9375, 0.916030534351145, 0.8888888888888888, 0.9302325581395349, 0.851063829787234, 0.8108108108108109, 0.8450704225352113, 0.8163265306122449, 0.821917808219178, 0.8333333333333334, 0.8163265306122449, 0.8, 0.7792207792207793, 0.821917808219178, 0.7843137254901961, 0.7017543859649122, 0.6779661016949152, 0.6857142857142857, 0.6557377049180327, 0.5660377358490566, 0.5150214592274678, 0.5286343612334802, 0.45627376425855515, 0.3883495145631068, 0.375, 0.36363636363636365, 0.32786885245901637, 0.3380281690140845, 0.23255813953488372, 0.22813688212927757, 0.17647058823529413, 0.1910828025477707, 0.14150943396226415, 0.14962593516209477, 0.13921113689095127]
ber_cpp=[0.20121031746031745, 0.1978174603174603, 0.1967063492063492, 0.19271825396825398, 0.18892857142857142, 0.18751984126984128, 0.18138888888888888, 0.18938492063492063, 0.18228174603174602, 0.17700396825396825, 0.171984126984127, 0.17476190476190476, 0.1721031746031746, 0.1682936507936508, 0.1673611111111111, 0.15678571428571428, 0.1557936507936508, 0.153234126984127, 0.1536706349206349, 0.14984126984126983, 0.1554761904761905, 0.14720582447855177, 0.14428571428571427, 0.13499999999999998, 0.131765873015873, 0.13271825396825396, 0.1267063492063492, 0.12634920634920635, 0.12481306572215664, 0.11737504919323101, 0.11190476190476191, 0.10344352617079891, 0.10609126984126985, 0.09988193624557261, 0.09620228256591894, 0.1001951600312256, 0.0957757296466974, 0.08618266978922716, 0.08636904761904761, 0.07941061670569867, 0.07414698162729658, 0.07666273120818576, 0.07301587301587302, 0.06471691038620171, 0.06075268817204301, 0.05937728937728938, 0.05262276785714286, 0.04943656852053799, 0.04617283950617284, 0.04953857511997047, 0.04316109422492401, 0.039157014157014156, 0.03378604963112005, 0.03840298023971494, 0.03124592302674494, 0.02964616402116402, 0.029446064139941688, 0.02565079365079365, 0.02196969696969697, 0.023825831702544032, 0.02233115468409586, 0.01874129768866611, 0.016464891041162225, 0.013673469387755101, 0.01479313036690086, 0.013668014375561545, 0.011945636623748212, 0.010289490245437382, 0.008808618504435995, 0.007065803667745414, 0.0054985119047619045, 0.0066522366522366524, 0.005418943533697632, 0.004419852448021462, 0.003783684016242156, 0.003503530689842477, 0.0020238095238095236, 0.0025818926296633303, 0.001580750224618149, 0.001466571666072913, 0.0014556402607446691]
plt.plot(esno, ber_cpp, label="cpp ber")
plt.plot(esno, fer_cpp, label="cpp fer")

fer_cpp=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 1.0, 0.9917355371900827, 1.0, 0.9917355371900827, 1.0, 0.9917355371900827, 0.9917355371900827, 0.9917355371900827, 0.9836065573770492, 0.9917355371900827, 0.9917355371900827, 0.975609756097561, 0.9523809523809523, 0.9917355371900827, 0.9917355371900827, 0.9448818897637795, 0.9917355371900827, 0.9523809523809523, 0.916030534351145, 0.9022556390977443, 0.8955223880597015, 0.8955223880597015, 0.8823529411764706, 0.8823529411764706, 0.851063829787234, 0.8333333333333334, 0.916030534351145, 0.8391608391608392, 0.8108108108108109, 0.8759124087591241, 0.9302325581395349, 0.8633093525179856, 0.9302325581395349, 0.8823529411764706, 0.8333333333333334, 0.8633093525179856, 0.7361963190184049, 0.8, 0.718562874251497, 0.6741573033707865, 0.547945205479452, 0.4878048780487805, 0.43795620437956206, 0.41522491349480967, 0.3007518796992481, 0.3076923076923077, 0.29850746268656714, 0.25806451612903225, 0.21352313167259787, 0.19672131147540983, 0.16238159675236807, 0.1628222523744912, 0.1373134328358209, 0.1373134328358209]
ber_cpp=[0.19654761904761905, 0.1962698412698413, 0.20093253968253968, 0.19142857142857142, 0.1908531746031746, 0.18666666666666665, 0.19617063492063494, 0.18470238095238095, 0.18234126984126983, 0.1816468253968254, 0.1706349206349206, 0.17422619047619048, 0.16930555555555554, 0.17023809523809522, 0.16162698412698412, 0.16593253968253968, 0.16025793650793652, 0.15319444444444444, 0.15593253968253967, 0.14722222222222223, 0.14436507936507936, 0.1473809523809524, 0.14317460317460318, 0.14003968253968252, 0.13394841269841268, 0.12853207398661945, 0.12970238095238096, 0.11708333333333334, 0.11981503345139707, 0.11882936507936508, 0.11115702479338842, 0.10630952380952381, 0.10230224321133412, 0.0990358126721763, 0.09777646595828414, 0.09617486338797814, 0.09110586383313656, 0.091086186540732, 0.08511420828493999, 0.07843915343915343, 0.07373081463990555, 0.07449822904368358, 0.06632920884889389, 0.07408500590318771, 0.05863567649281935, 0.06059614685568884, 0.05701754385964912, 0.05366027007818053, 0.050124378109452736, 0.04982492997198879, 0.04170168067226891, 0.037960148598446465, 0.04027777777777777, 0.040221737549981824, 0.028554778554778552, 0.026287001287001288, 0.023409801876955162, 0.028737541528239204, 0.021531346351490236, 0.023661867847914356, 0.022443977591036415, 0.016154100529100532, 0.019184652278177457, 0.016272275781478236, 0.014984126984126983, 0.01122041631023667, 0.01203852327447833, 0.008621439443357252, 0.00797522260936895, 0.006404240528328119, 0.006912176635360027, 0.004576918486692923, 0.0044566544566544564, 0.004240701255626629, 0.004014336917562724, 0.003092696153194374, 0.0030835284933645587, 0.0023100715252271408, 0.0018382115397040772, 0.0016819864675092556, 0.0016819864675092556]
plt.plot(esno, ber_cpp, label="cpp ber_fixIter")
plt.plot(esno, fer_cpp, label="cpp fer_fixIter")

plt.yscale("log")  # Логарифмическая шкала по Y
plt.xlabel("EsNo [dB]")
plt.ylabel("BER")
# plt.title("GLDPC на основе LDPC(420,364) и BCJR(15,11)")
plt.legend(
    # loc='lower right',
    # bbox_to_anchor=(0.5, -0.1),  
    # ncol=2,                
    fontsize=8,
    # frameon=False     
)
plt.grid(True, which="both", linestyle="--")
plt.savefig('modeling_results/compare.png', dpi=300, bbox_inches='tight')