from matplotlib.ticker import FuncFormatter, MultipleLocator
from scipy.ndimage import gaussian_filter1d
from matplotlib import pyplot as plt
# ldpc 420 224 <- bch15 11 до 20 итераций
# esno=[-1, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1, -0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]

# fer_py=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9836065573770492, 1.0, 1.0, 0.975609756097561, 0.9523809523809523, 0.9836065573770492, 0.967741935483871, 0.9302325581395349, 0.8633093525179856, 0.9090909090909091, 0.8633093525179856, 0.7947019867549668, 0.7947019867549668]
# ber_py=[0.22642857142857142, 0.2222420634920635, 0.21386904761904763, 0.20720238095238094, 0.20521825396825397, 0.19343253968253968, 0.1928968253968254, 0.1875, 0.18659250585480094, 0.17424603174603173, 0.17160714285714285, 0.16045296167247386, 0.15461073318216176, 0.13436768149882902, 0.1377304147465438, 0.12914359542266518, 0.1169921205892429, 0.11713564213564213, 0.09753340184994862, 0.09200567644276253, 0.08771680857773573]
# plt.plot(esno, ber_py, label="py ber")
# plt.plot(esno, fer_py, label="py fer")


# fer_cpp=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 0.9836065573770492, 0.9836065573770492, 0.9917355371900827, 0.967741935483871]
# ber_cpp=[0.19666666666666668, 0.19448412698412698, 0.1839484126984127, 0.18327380952380953, 0.17888888888888888, 0.1771825396825397, 0.17259920634920636, 0.16553571428571429, 0.1555952380952381, 0.15527777777777776, 0.14113095238095238, 0.14011904761904762, 0.1334126984126984, 0.12946428571428573, 0.12311507936507936, 0.11287698412698413, 0.10236127508854782, 0.09822404371584699, 0.08830991412958626, 0.08573396300669027, 0.0762288786482335]
# plt.plot(esno, ber_cpp, label="cpp ber")
# plt.plot(esno, fer_cpp, label="cpp fer")

# ldpc 420 224 <- bch15 11 4 итерации
# esno=[-1, -0.95, -0.9, -0.85, -0.8, -0.75, -0.7, -0.65, -0.6, -0.55, -0.5, -0.45, -0.4, -0.35, -0.3, -0.25, -0.2, -0.15, -0.1, -0.05, -0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0, 1.05, 1.1, 1.15, 1.2, 1.25, 1.3, 1.35, 1.4, 1.45, 1.5, 1.55, 1.6, 1.65, 1.7, 1.75, 1.8, 1.85, 1.9, 1.95, 2.0, 2.05, 2.1, 2.15, 2.2, 2.25, 2.3, 2.35, 2.4, 2.45, 2.5, 2.55, 2.6, 2.65, 2.7, 2.75, 2.8, 2.85, 2.9, 2.95, 3.0] # 

# fer_py=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 0.9917355371900827, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 1.0, 0.9917355371900827, 1.0, 0.9917355371900827, 1.0, 0.967741935483871, 0.9917355371900827, 0.9836065573770492, 0.9917355371900827, 0.9917355371900827, 0.9523809523809523, 0.96, 0.9836065573770492, 0.967741935483871, 0.9917355371900827, 0.9523809523809523, 0.9375, 0.9302325581395349, 0.8955223880597015, 0.8955223880597015, 0.9448818897637795, 0.8275862068965517, 0.9090909090909091, 0.8275862068965517, 0.8, 0.8275862068965517, 0.7692307692307693, 0.6936416184971098, 0.7547169811320755, 0.6818181818181818, 0.6557377049180327, 0.631578947368421, 0.5607476635514018, 0.6282722513089005, 0.594059405940594, 0.5286343612334802, 0.49586776859504134, 0.5172413793103449, 0.43956043956043955, 0.40540540540540543, 0.425531914893617, 0.3157894736842105, 0.3519061583577713, 0.2733485193621868, 0.2569593147751606, 0.21660649819494585, 0.21621621621621623, 0.20797227036395147, 0.20270270270270271, 0.1938610662358643, 0.13856812933025403, 0.14634146341463414]
# ber_py=[0.19807539682539682, 0.19843253968253968, 0.19650793650793652, 0.1863293650793651, 0.19027777777777777, 0.18896825396825398, 0.18910714285714286, 0.1893253968253968, 0.18662698412698414, 0.17817460317460315, 0.17972222222222223, 0.17569444444444443, 0.17015873015873015, 0.16781746031746034, 0.16638888888888886, 0.1640873015873016, 0.16561507936507935, 0.15944444444444444, 0.1514484126984127, 0.1555686737504919, 0.14547422274695002, 0.1334126984126984, 0.13996031746031745, 0.13825396825396827, 0.13371031746031745, 0.13234126984126984, 0.11952380952380953, 0.11918536009445099, 0.12716269841269842, 0.11890873015873016, 0.10775285320739866, 0.10759920634920635, 0.10403384494293585, 0.10823412698412697, 0.09951996927803379, 0.09742227469500196, 0.08629976580796253, 0.08353010625737899, 0.08358913813459268, 0.08223733938019653, 0.0745904761904762, 0.07730288836846214, 0.06582181259600614, 0.0649547422274695, 0.05958049886621315, 0.05466889880952381, 0.05939461055740126, 0.05216773276474769, 0.04557569296375266, 0.045556805399325086, 0.035632183908045977, 0.037770562770562774, 0.03799671592775041, 0.03296825396825397, 0.03157635467980295, 0.028098290598290603, 0.024346270300027527, 0.026205450733752623, 0.021347402597402598, 0.01916471506635441, 0.01893483709273183, 0.014463729417000446, 0.014385440039890302, 0.01452145214521452, 0.013436123348017621, 0.0108913813459268, 0.009831691297208537, 0.009009244723530438, 0.008108108108108109, 0.007776089159067883, 0.00606516290726817, 0.005481078061723223, 0.004159887189499945, 0.003767716936881819, 0.0030556988138215574, 0.002672672672672673, 0.002628538417099942, 0.002376930501930502, 0.0027579044541887836, 0.0015808863961288904, 0.0015708478513356563]
# plt.plot(esno, ber_py, label="py ber")
# plt.plot(esno, fer_py, label="py fer")

# fer_cpp=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9836065573770492, 0.967741935483871, 0.9917355371900827, 1.0, 1.0, 0.9836065573770492, 0.975609756097561, 0.9836065573770492, 0.96, 0.9917355371900827, 0.96, 0.9302325581395349, 0.96, 0.9090909090909091, 0.9230769230769231, 0.9090909090909091, 0.8759124087591241, 0.8759124087591241, 0.851063829787234, 0.8823529411764706, 0.8633093525179856, 0.8391608391608392, 0.8695652173913043, 0.7741935483870968, 0.8571428571428571, 0.7741935483870968, 0.7692307692307693, 0.7643312101910829, 0.7643312101910829, 0.7058823529411765, 0.718562874251497, 0.6666666666666666, 0.6, 0.5555555555555556, 0.5194805194805194, 0.45627376425855515, 0.44280442804428044, 0.4013377926421405, 0.35294117647058826, 0.3448275862068966, 0.3342618384401114, 0.23166023166023167, 0.26200873362445415, 0.2037351443123939, 0.21818181818181817, 0.18633540372670807, 0.16371077762619374, 0.14869888475836432, 0.1340782122905028,]
# ber_cpp=[0.2019047619047619, 0.20444444444444446, 0.19496031746031747, 0.18658730158730158, 0.1925, 0.18468253968253967, 0.1918452380952381, 0.1861111111111111, 0.17942460317460318, 0.17888888888888888, 0.1740079365079365, 0.1758531746031746, 0.1673611111111111, 0.16660714285714287, 0.16537698412698412, 0.16208333333333333, 0.1555753968253968, 0.1584325396825397, 0.1545436507936508, 0.1532738095238095, 0.14779761904761904, 0.13855158730158731, 0.13793650793650794, 0.13974813065722155, 0.1332142857142857, 0.13232142857142856, 0.1338888888888889, 0.1256547619047619, 0.11390873015873017, 0.11630952380952381, 0.1113888888888889, 0.11192460317460316, 0.10023419203747072, 0.09903993855606759, 0.09295552931916568, 0.09869047619047619, 0.09148809523809523, 0.0907103825136612, 0.08579171506000774, 0.07550741608118658, 0.07836190476190477, 0.06759149940968123, 0.06916190476190477, 0.06775562938353637, 0.0691047619047619, 0.05907287157287157, 0.05575091575091575, 0.05061327561327562, 0.04907890163364616, 0.043917274939172746, 0.04375211077338737, 0.03949579831932773, 0.03860911270983213, 0.035814185814185814, 0.03668046928916494, 0.03422427035330261, 0.0341156462585034, 0.034086021505376346, 0.035897435897435895, 0.0345920533818623, 0.02870791628753412, 0.029397759103641456, 0.029726261762189905, 0.025595238095238095, 0.020607142857142855, 0.017184744268077604, 0.016079158936301793, 0.011126199529241354, 0.011711474257599719, 0.009945851250199077, 0.00773109243697479, 0.006096059113300492, 0.005823053455365434, 0.0037277072991358704, 0.004174464545643585, 0.0031207049882771443, 0.0027445887445887445, 0.002580597456373854, 0.0018547391671539012, 0.0017672744438543696, 0.001628092577813248,]
# plt.plot(esno, ber_cpp, label="cpp ber?")
# plt.plot(esno, fer_cpp, label="cpp fer?")

#ldpc 420 224 <- bch15 11 4 итерации
# esno=[-1, -0.95, -0.9, -0.85, -0.8, -0.75, -0.7, -0.65, -0.6, -0.55, -0.5, -0.45, -0.4, -0.35, -0.3, -0.25, -0.2, -0.15, -0.1, -0.05, 0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0, 1.05, 1.1, 1.15, 1.2, 1.25, 1.3, 1.35, 1.4, 1.45, 1.5, 1.55, 1.6, 1.65, 1.7, 1.75, 1.8, 1.85, 1.9, 1.95, 2.0, 2.05, 2.1, 2.15, 2.2, 2.25, 2.3, 2.35, 2.4, 2.45, 2.5, 2.55, 2.6, 2.65, 2.7, 2.75, 2.8, 2.85, 2.9, 2.95, 3.0]

# fer_py=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 0.9917355371900827, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 1.0, 0.9917355371900827, 1.0, 0.9917355371900827, 1.0, 0.967741935483871, 0.9917355371900827, 0.9836065573770492, 0.9917355371900827, 0.9917355371900827, 0.9523809523809523, 0.96, 0.9836065573770492, 0.967741935483871, 0.9917355371900827, 0.9523809523809523, 0.9375, 0.9302325581395349, 0.8955223880597015, 0.8955223880597015, 0.9448818897637795, 0.8275862068965517, 0.9090909090909091, 0.8275862068965517, 0.8, 0.8275862068965517, 0.7692307692307693, 0.6936416184971098, 0.7547169811320755, 0.6818181818181818, 0.6557377049180327, 0.631578947368421, 0.5607476635514018, 0.6282722513089005, 0.594059405940594, 0.5286343612334802, 0.49586776859504134, 0.5172413793103449, 0.43956043956043955, 0.40540540540540543, 0.425531914893617, 0.3157894736842105, 0.3519061583577713, 0.2733485193621868, 0.2569593147751606, 0.21660649819494585, 0.21621621621621623, 0.20797227036395147, 0.20270270270270271, 0.1938610662358643, 0.13856812933025403, 0.14634146341463414]
# ber_py=[0.19807539682539682, 0.19843253968253968, 0.19650793650793652, 0.1863293650793651, 0.19027777777777777, 0.18896825396825398, 0.18910714285714286, 0.1893253968253968, 0.18662698412698414, 0.17817460317460315, 0.17972222222222223, 0.17569444444444443, 0.17015873015873015, 0.16781746031746034, 0.16638888888888886, 0.1640873015873016, 0.16561507936507935, 0.15944444444444444, 0.1514484126984127, 0.1555686737504919, 0.14547422274695002, 0.1334126984126984, 0.13996031746031745, 0.13825396825396827, 0.13371031746031745, 0.13234126984126984, 0.11952380952380953, 0.11918536009445099, 0.12716269841269842, 0.11890873015873016, 0.10775285320739866, 0.10759920634920635, 0.10403384494293585, 0.10823412698412697, 0.09951996927803379, 0.09742227469500196, 0.08629976580796253, 0.08353010625737899, 0.08358913813459268, 0.08223733938019653, 0.0745904761904762, 0.07730288836846214, 0.06582181259600614, 0.0649547422274695, 0.05958049886621315, 0.05466889880952381, 0.05939461055740126, 0.05216773276474769, 0.04557569296375266, 0.045556805399325086, 0.035632183908045977, 0.037770562770562774, 0.03799671592775041, 0.03296825396825397, 0.03157635467980295, 0.028098290598290603, 0.024346270300027527, 0.026205450733752623, 0.021347402597402598, 0.01916471506635441, 0.01893483709273183, 0.014463729417000446, 0.014385440039890302, 0.01452145214521452, 0.013436123348017621, 0.0108913813459268, 0.009831691297208537, 0.009009244723530438, 0.008108108108108109, 0.007776089159067883, 0.00606516290726817, 0.005481078061723223, 0.004159887189499945, 0.003767716936881819, 0.0030556988138215574, 0.002672672672672673, 0.002628538417099942, 0.002376930501930502, 0.0027579044541887836, 0.0015808863961288904, 0.0015708478513356563]
# plt.plot(esno, ber_py, label="py ber")
# plt.plot(esno, fer_py, label="py fer")


# fer_cpp=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 0.9917355371900827, 1.0, 0.9917355371900827, 1.0, 0.9917355371900827, 0.9917355371900827, 0.9836065573770492, 0.967741935483871, 0.9836065573770492, 1.0, 0.9836065573770492, 0.9448818897637795, 0.9917355371900827, 0.9302325581395349, 0.9448818897637795, 0.967741935483871, 0.9230769230769231, 0.9375, 0.916030534351145, 0.8888888888888888, 0.9302325581395349, 0.851063829787234, 0.8108108108108109, 0.8450704225352113, 0.8163265306122449, 0.821917808219178, 0.8333333333333334, 0.8163265306122449, 0.8, 0.7792207792207793, 0.821917808219178, 0.7843137254901961, 0.7017543859649122, 0.6779661016949152, 0.6857142857142857, 0.6557377049180327, 0.5660377358490566, 0.5150214592274678, 0.5286343612334802, 0.45627376425855515, 0.3883495145631068, 0.375, 0.36363636363636365, 0.32786885245901637, 0.3380281690140845, 0.23255813953488372, 0.22813688212927757, 0.17647058823529413, 0.1910828025477707, 0.14150943396226415, 0.14962593516209477, 0.13921113689095127]
# ber_cpp=[0.20121031746031745, 0.1978174603174603, 0.1967063492063492, 0.19271825396825398, 0.18892857142857142, 0.18751984126984128, 0.18138888888888888, 0.18938492063492063, 0.18228174603174602, 0.17700396825396825, 0.171984126984127, 0.17476190476190476, 0.1721031746031746, 0.1682936507936508, 0.1673611111111111, 0.15678571428571428, 0.1557936507936508, 0.153234126984127, 0.1536706349206349, 0.14984126984126983, 0.1554761904761905, 0.14720582447855177, 0.14428571428571427, 0.13499999999999998, 0.131765873015873, 0.13271825396825396, 0.1267063492063492, 0.12634920634920635, 0.12481306572215664, 0.11737504919323101, 0.11190476190476191, 0.10344352617079891, 0.10609126984126985, 0.09988193624557261, 0.09620228256591894, 0.1001951600312256, 0.0957757296466974, 0.08618266978922716, 0.08636904761904761, 0.07941061670569867, 0.07414698162729658, 0.07666273120818576, 0.07301587301587302, 0.06471691038620171, 0.06075268817204301, 0.05937728937728938, 0.05262276785714286, 0.04943656852053799, 0.04617283950617284, 0.04953857511997047, 0.04316109422492401, 0.039157014157014156, 0.03378604963112005, 0.03840298023971494, 0.03124592302674494, 0.02964616402116402, 0.029446064139941688, 0.02565079365079365, 0.02196969696969697, 0.023825831702544032, 0.02233115468409586, 0.01874129768866611, 0.016464891041162225, 0.013673469387755101, 0.01479313036690086, 0.013668014375561545, 0.011945636623748212, 0.010289490245437382, 0.008808618504435995, 0.007065803667745414, 0.0054985119047619045, 0.0066522366522366524, 0.005418943533697632, 0.004419852448021462, 0.003783684016242156, 0.003503530689842477, 0.0020238095238095236, 0.0025818926296633303, 0.001580750224618149, 0.001466571666072913, 0.0014556402607446691]
# plt.plot(esno, ber_cpp, label="cpp ber")
# plt.plot(esno, fer_cpp, label="cpp fer")

# fer_cpp=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 1.0, 0.9917355371900827, 1.0, 0.9917355371900827, 1.0, 0.9917355371900827, 0.9917355371900827, 0.9917355371900827, 0.9836065573770492, 0.9917355371900827, 0.9917355371900827, 0.975609756097561, 0.9523809523809523, 0.9917355371900827, 0.9917355371900827, 0.9448818897637795, 0.9917355371900827, 0.9523809523809523, 0.916030534351145, 0.9022556390977443, 0.8955223880597015, 0.8955223880597015, 0.8823529411764706, 0.8823529411764706, 0.851063829787234, 0.8333333333333334, 0.916030534351145, 0.8391608391608392, 0.8108108108108109, 0.8759124087591241, 0.9302325581395349, 0.8633093525179856, 0.9302325581395349, 0.8823529411764706, 0.8333333333333334, 0.8633093525179856, 0.7361963190184049, 0.8, 0.718562874251497, 0.6741573033707865, 0.547945205479452, 0.4878048780487805, 0.43795620437956206, 0.41522491349480967, 0.3007518796992481, 0.3076923076923077, 0.29850746268656714, 0.25806451612903225, 0.21352313167259787, 0.19672131147540983, 0.16238159675236807, 0.1628222523744912, 0.1373134328358209, 0.1373134328358209]
# ber_cpp=[0.19654761904761905, 0.1962698412698413, 0.20093253968253968, 0.19142857142857142, 0.1908531746031746, 0.18666666666666665, 0.19617063492063494, 0.18470238095238095, 0.18234126984126983, 0.1816468253968254, 0.1706349206349206, 0.17422619047619048, 0.16930555555555554, 0.17023809523809522, 0.16162698412698412, 0.16593253968253968, 0.16025793650793652, 0.15319444444444444, 0.15593253968253967, 0.14722222222222223, 0.14436507936507936, 0.1473809523809524, 0.14317460317460318, 0.14003968253968252, 0.13394841269841268, 0.12853207398661945, 0.12970238095238096, 0.11708333333333334, 0.11981503345139707, 0.11882936507936508, 0.11115702479338842, 0.10630952380952381, 0.10230224321133412, 0.0990358126721763, 0.09777646595828414, 0.09617486338797814, 0.09110586383313656, 0.091086186540732, 0.08511420828493999, 0.07843915343915343, 0.07373081463990555, 0.07449822904368358, 0.06632920884889389, 0.07408500590318771, 0.05863567649281935, 0.06059614685568884, 0.05701754385964912, 0.05366027007818053, 0.050124378109452736, 0.04982492997198879, 0.04170168067226891, 0.037960148598446465, 0.04027777777777777, 0.040221737549981824, 0.028554778554778552, 0.026287001287001288, 0.023409801876955162, 0.028737541528239204, 0.021531346351490236, 0.023661867847914356, 0.022443977591036415, 0.016154100529100532, 0.019184652278177457, 0.016272275781478236, 0.014984126984126983, 0.01122041631023667, 0.01203852327447833, 0.008621439443357252, 0.00797522260936895, 0.006404240528328119, 0.006912176635360027, 0.004576918486692923, 0.0044566544566544564, 0.004240701255626629, 0.004014336917562724, 0.003092696153194374, 0.0030835284933645587, 0.0023100715252271408, 0.0018382115397040772, 0.0016819864675092556, 0.0016819864675092556]
# plt.plot(esno, ber_cpp, label="cpp ber_fixIter")
# plt.plot(esno, fer_cpp, label="cpp fer_fixIter")

#ldpc 420 224 <- bch15 11 3 итерации
esno=[-1, -0.95, -0.9, -0.85, -0.8, -0.75, -0.7, -0.65, -0.6, -0.55, -0.5, -0.45, -0.4, -0.35, -0.3, -0.25, -0.2, -0.15, -0.1, -0.05, 0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0, 1.05, 1.1, 1.15, 1.2, 1.25, 1.3, 1.35, 1.4, 1.45, 1.5, 1.55, 1.6, 1.65, 1.7, 1.75, 1.8, 1.85, 1.9, 1.95, 2.0, 2.05, 2.1, 2.15, 2.2, 2.25, 2.3, 2.35, 2.4, 2.45, 2.5, 2.55, 2.6, 2.65, 2.7, 2.75, 2.8, 2.85, 2.9, 2.95, 3.0, 3.05, 3.1, 3.15, 3.2, 3.25, ]

fer_2=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9836065573770492, 1.0, 0.9836065573770492, 1.0, 1.0, 0.9917355371900827, 0.9917355371900827, 0.9917355371900827, 0.9448818897637795, 0.9836065573770492, 0.9917355371900827, 0.967741935483871, 0.967741935483871, 0.975609756097561, 0.975609756097561, 0.9302325581395349, 0.8823529411764706, 0.9523809523809523, 0.8888888888888888, 0.8823529411764706, 0.8823529411764706, 0.8571428571428571, 0.8695652173913043, 0.8391608391608392, 0.7643312101910829, 0.7317073170731707, 0.7741935483870968, 0.7453416149068323, 0.6666666666666666, 0.6593406593406593, 0.6153846153846154, 0.6382978723404256, 0.5405405405405406, 0.6153846153846154, 0.6185567010309279, 0.48, 0.47058823529411764, 0.4166666666666667, 0.4743083003952569, 0.38961038961038963, 0.36923076923076925, 0.32085561497326204, 0.29850746268656714, 0.2553191489361702, 0.267260579064588, 0.23668639053254437, 0.1986754966887417, 0.22099447513812154, 0.18604651162790697, ]
ber_2=[0.20164682539682538, 0.19253968253968254, 0.18769841269841273, 0.1913888888888889, 0.1854563492063492, 0.18472222222222223, 0.1805753968253968, 0.18511904761904763, 0.1738888888888889, 0.18089285714285713, 0.17228174603174604, 0.17081349206349206, 0.17069444444444445, 0.1673611111111111, 0.1611904761904762, 0.16503968253968254, 0.16055555555555553, 0.14813492063492062, 0.1536309523809524, 0.1544246031746032, 0.14238095238095239, 0.14194444444444446, 0.1371626984126984, 0.1319047619047619, 0.1324206349206349, 0.12805555555555556, 0.1240873015873016, 0.12436507936507937, 0.11950396825396825, 0.11311507936507938, 0.10670634920634921, 0.10535222353404171, 0.10634920634920636, 0.10579365079365079, 0.10083333333333333, 0.0977579365079365, 0.09714285714285714, 0.08272833723653396, 0.08549603174603175, 0.08206479313036691, 0.08007936507936507, 0.07269841269841269, 0.06922471467926014, 0.06835891381345928, 0.0667650531286895, 0.06042369703787027, 0.059035909445745514, 0.05960251869342779, 0.05695084485407066, 0.05142089093701997, 0.04574138598528843, 0.045470383275261324, 0.04293097083794758, 0.038322829131652664, 0.038000755857898715, 0.029788359788359788, 0.02967436974789916, 0.03079481792717087, 0.027108843537414964, 0.027087646652864044, 0.02629037629037629, 0.019790718835304824, 0.02020905923344948, 0.019831029185867897, 0.019787045252883762, 0.013981481481481482, 0.015083725798011512, 0.01387057387057387, 0.011841438703140831, 0.010263835263835263, 0.011074481074481075, 0.01061610211094747, 0.007276190476190476, 0.0062651727357609715, 0.004976851851851852, 0.006342932429888952, 0.004630488559059988, 0.004293040293040293, 0.0035014005602240898, 0.003997867803837953, 0.0025481256332320163, 0.003027892671545233, 0.002127359819667512, 0.001868495742667928, 0.002223099184425151, 0.0018604651162790697,]
# plt.plot(esno, ber_2, label="ber_2")
plt.plot(esno, fer_2, label="fer_2")

esno_1 = [-1, -0.95, -0.9, -0.85, -0.8, -0.75, -0.7, -0.65, -0.6, -0.55, -0.5, -0.45, -0.4, -0.35, -0.3, -0.25, -0.2, -0.15, -0.1, -0.05, 0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0, 1.05, 1.1, 1.15, 1.2, 1.25, 1.3, 1.35, 1.4, 1.45, 1.5, 1.55, 1.6, 1.65, 1.7, 1.75, 1.8, 1.85, 1.9, 1.95, 2.0, 2.05, 2.1, 2.15, 2.2, 2.25, 2.3, 2.35, 2.4, 2.45, 2.5, 2.55, 2.6, 2.65, 2.7, 2.75, 2.8, 2.85, 2.9, 2.95, 3.0, 3.05, 3.1, 3.15, 3.2, 3.25, 3.3, 3.35, 3.4, 3.45, 3.5, 3.55, 3.6, 3.65, 3.7]
fer_1=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 0.9917355371900827, 0.9836065573770492, 0.975609756097561, 0.975609756097561, 0.9836065573770492, 0.9917355371900827, 0.975609756097561, 0.9836065573770492, 0.967741935483871, 0.9836065573770492, 0.9836065573770492, 0.96, 0.9090909090909091, 0.9090909090909091, 0.9022556390977443, 0.916030534351145, 0.916030534351145, 0.8695652173913043, 0.8053691275167785, 0.851063829787234, 0.8108108108108109, 0.8108108108108109, 0.7692307692307693, 0.7643312101910829, 0.7547169811320755, 0.7017543859649122, 0.6936416184971098, 0.6593406593406593, 0.6185567010309279, 0.5714285714285714, 0.5882352941176471, 0.5607476635514018, 0.5286343612334802, 0.4819277108433735, 0.4819277108433735, 0.3519061583577713, 0.35398230088495575, 0.40816326530612246, 0.3468208092485549, 0.3342618384401114, 0.2777777777777778, 0.27522935779816515, 0.19575856443719414, 0.2094240837696335, 0.1895734597156398, 0.17069701280227595, 0.15113350125944586, 0.17094017094017094, 0.11549566891241578, 0.13100436681222707, 0.1188118811881188, 0.09700889248181083, 0.08528784648187633, 0.1001669449081803, 0.10752688172043011, ]
ber_1=[0.19547619047619047, 0.19212301587301586, 0.190734126984127, 0.1860515873015873, 0.1885515873015873, 0.18424603174603177, 0.1708730158730159, 0.17492063492063492, 0.1817063492063492, 0.17539682539682538, 0.17375000000000002, 0.17113095238095238, 0.1725, 0.16311507936507935, 0.16160714285714287, 0.1644642857142857, 0.15464285714285714, 0.15208333333333332, 0.1444047619047619, 0.1515277777777778, 0.1478373015873016, 0.14603174603174604, 0.1412301587301587, 0.13501984126984126, 0.1298015873015873, 0.13345238095238096, 0.12549603174603174, 0.12551587301587303, 0.11601190476190476, 0.11990079365079365, 0.1130357142857143, 0.11259920634920635, 0.10859126984126985, 0.10398809523809523, 0.09417552144824873, 0.09523809523809525, 0.08825396825396825, 0.0848015873015873, 0.08388429752066116, 0.0773015873015873, 0.07611176702085792, 0.0766783762685402, 0.074312814556717, 0.07013162988772745, 0.06533957845433255, 0.06025186934277843, 0.0591947348044909, 0.05856752537080406, 0.05526113671274961, 0.051541764246682276, 0.05015612802498048, 0.05055238095238095, 0.043362193362193366, 0.04179292929292929, 0.03532044396706051, 0.034369320247182845, 0.03444202108324246, 0.025638371290545203, 0.02620645573665708, 0.026308679500168863, 0.022844272844272845, 0.022763835263835262, 0.019993894993894996, 0.0189111313315135, 0.018104222821203952, 0.016819827346143134, 0.015139003578309936, 0.012964416535845107, 0.013794796269023073, 0.009002267573696146, 0.010410830999066293, 0.009457053849577214, 0.007803650094398993, 0.006769936890418818, 0.006444826926754638, 0.004971372713308197, 0.00468464672004495, 0.005174927113702624, 0.004376548307184145, 0.004191537339169651, 0.00248015873015873, 0.002959807776321538, 0.0018527149848520158, 0.002115017036483005, 0.0018280297901150982, 0.0014698909435751542, 0.001274439246731438, 0.0014753764753764754, 0.0009464228424767404, 0.001091703056768559, 0.0010513908533710515, 0.0009412172306270932, 0.0008613395606999018, 0.001108991175769139, 0.0014742276839051032, ]
# plt.plot(esno_1, ber_1, label="ber")
plt.plot(esno_1, fer_1, label="fer")

esno_t= [ 3.35, 3.4, 3.45, 3.5, 3.55, 3.6, 3.65, 3.7, 3.75, 3.8, 3.85, 3.9, 3.95, 4.0]
fer1_c_t= [0.13528748590755355, 0.13392857142857142, 0.12422360248447205, 0.09876543209876543, 0.08409250175192712, 0.08075370121130551, 0.07058823529411765, 0.05997001499250375, 0.07054673721340388, 0.06406833956219968, 0.08658008658008658, 0.07638446849140675, 0.07751937984496124, 0.08403361344537816]
ber1_c_t=[0.0011676598486068611, 0.001062925170068027, 0.001067238489598738, 0.0008896727415245933, 0.0007892014549337605, 0.0006905723258347753, 0.0005854341736694678, 0.0005556745436805407, 0.0008034489515970997, 0.0008707700912719599, 0.001393183536040679, 0.0013670394956200175, 0.0014888642795619538, 0.002017473656129118, ]

fer2_c_t=[0.14167650531286896, 0.11527377521613832, 0.10840108401084012, 0.10186757215619695, 0.08207934336525308, 0.07551919446192575, 0.08064516129032258, 0.0823045267489712, 0.07001166861143523, 0.07366482504604052, 0.07585335018963338, 0.06423982869379015, 0.09125475285171103, 0.0837404047452896]
ber2_c_t=[0.0013211896328779447, 0.001061250628973972, 0.000886135845485439, 0.000701350149567467, 0.0007002801120448178, 0.0006473073811022206, 0.000737647209421403, 0.0008899993467894702, 0.0009376562760460077, 0.000985120874623637, 0.0012311119137920655, 0.0012376363821759967, 0.002022451566177802, 0.002033695543814176,]

esno_t_py=[3.3, 3.35, 3.4, 3.45, 3.5, 3.55, 3.6, 3.65, 3.7, 3.75, 3.8, 3.85,]
fer1_py_t = [0.15544041450777202, 0.13528748590755355, 0.13100436681222707, 0.10666666666666667, 0.09740259740259741, 0.09181331293037491, 0.08727272727272728, 0.07352941176470588, 0.05991013479780329, 0.05161290322580645, 0.05316792202038104, 0.046153846153846156]
ber1_py_t=[0.0014958055761164568, 0.0012723465936543728, 0.0011046995217300895, 0.0009121693121693121, 0.000716991341991342, 0.0007122818522971546, 0.0006372294372294372, 0.0005777310924369748, 0.00047666595345077626, 0.00035637480798771126, 0.00034812329894297106, 0.00031055900621118014, ]
plt.plot(esno_t, fer1_c_t, label='fer1_c_t')
plt.plot(esno_t, fer2_c_t, label='fer2_c_t')
plt.plot(esno_t_py, fer1_py_t, label='fer1_py_t')



# # ldpc 420 224 <- bch15 11 2 итерации
# esno=[-1, -0.95, -0.9, -0.85, -0.8, -0.75, -0.7, -0.65, -0.6, -0.55, -0.5, -0.45, -0.4, -0.35, -0.3, -0.25, -0.2, -0.15, -0.1, -0.05, 0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0, 1.05, 1.1, 1.15, 1.2, 1.25, 1.3, 1.35, 1.4, 1.45, 1.5, 1.55, 1.6, 1.65, 1.7, 1.75, 1.8, 1.85, 1.9, 1.95, 2.0, 2.05, 2.1, 2.15, 2.2, 2.25, 2.3, 2.35, 2.4, 2.45, 2.5, 2.55, 2.6, 2.65, 2.7, 2.75, 2.8, 2.85, 2.9, 2.95, 3.0, 3.05, 3.1, 3.15, 3.2, 3.25, 3.3, 3.35, 3.4, 3.45, 3.5, 3.55, 3.6, 3.65, 3.7, 3.75, 3.8, 3.85, 3.9, 3.95, 4.0, 4.05, 4.1, 4.15, 4.2, 4.25, 4.3, 4.35, 4.4, 4.45, 4.5, ]

# fer_2=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9836065573770492, 1.0, 0.9917355371900827, 0.9917355371900827, 1.0, 0.9836065573770492, 1.0, 1.0, 0.9836065573770492, 0.9917355371900827, 0.9917355371900827, 0.9917355371900827, 1.0, 0.9523809523809523, 0.975609756097561, 0.96, 0.9375, 0.9448818897637795, 0.8633093525179856, 0.916030534351145, 0.8823529411764706, 0.8888888888888888, 0.8888888888888888, 0.8759124087591241, 0.8888888888888888, 0.8053691275167785, 0.7741935483870968, 0.7142857142857143, 0.7547169811320755, 0.759493670886076, 0.6976744186046512, 0.7361963190184049, 0.6486486486486487, 0.6896551724137931, 0.631578947368421, 0.5555555555555556, 0.6060606060606061, 0.5555555555555556, 0.5194805194805194, 0.4669260700389105, 0.38461538461538464, 0.38961038961038963, 0.3669724770642202, 0.32085561497326204, 0.33240997229916897, 0.33707865168539325, 0.29484029484029484, 0.24242424242424243, 0.2222222222222222, 0.19834710743801653, 0.18376722817764166, 0.18808777429467086, 0.15978695073235685, 0.1251303441084463, 0.11583011583011583, 0.11183597390493942, 0.11494252873563218, 0.0847457627118644, 0.0730816077953715, 0.07609384908053266, 0.061951471347444505, 0.0557361820715281]
# ber_2=[0.19071428571428573, 0.1854563492063492, 0.1807936507936508, 0.18283730158730158, 0.18337301587301588, 0.18115079365079365, 0.17938492063492062, 0.17069444444444445, 0.16884920634920636, 0.17011904761904761, 0.17101190476190478, 0.1684920634920635, 0.15996031746031747, 0.1577579365079365, 0.16033730158730158, 0.15311507936507937, 0.14910714285714285, 0.14876984126984125, 0.1518253968253968, 0.14801587301587302, 0.14317460317460318, 0.1413095238095238, 0.13450396825396824, 0.13579365079365077, 0.13109126984126984, 0.12513888888888888, 0.1284722222222222, 0.1292261904761905, 0.12648809523809523, 0.11494047619047619, 0.10753968253968255, 0.11005952380952382, 0.10813492063492064, 0.1027579365079365, 0.1115873015873016, 0.09960317460317461, 0.09855158730158729, 0.09406746031746031, 0.08863095238095238, 0.08906746031746032, 0.08654761904761905, 0.08726879181424636, 0.08343253968253969, 0.07628968253968255, 0.07432539682539682, 0.07511904761904761, 0.07003968253968254, 0.06880952380952382, 0.06976190476190476, 0.06129976580796253, 0.06160714285714286, 0.054604486422668234, 0.05608028335301062, 0.048650793650793646, 0.04658469945355191, 0.04894841269841269, 0.041706349206349205, 0.0429352068696331, 0.03787878787878787, 0.03469106650924833, 0.03762298307752853, 0.033134920634920635, 0.029743008314436888, 0.031687959736740226, 0.029885714285714286, 0.02416294642857143, 0.02557180352455943, 0.023484069886947585, 0.022646310432569976, 0.018224789915966388, 0.017724867724867723, 0.019082892416225752, 0.016319082377476538, 0.016684303350970018, 0.013998082454458294, 0.01284178187403994, 0.012698412698412698, 0.010527103923330339, 0.010880048221820374, 0.008942414174972315, 0.009144025708442886, 0.008056628056628056, 0.006759715380405036, 0.006616541353383459, 0.00574294532627866, 0.006180856180856181, 0.0052579365079365075, 0.004627911770768913, 0.003881786177506022, 0.003281440781440781, 0.0032081014223871366, 0.0028396679772826564, 0.0021008403361344537, 0.002334784329244163, 0.002441144997324773, 0.0019012519012519013, 0.0015536315536315538, 0.0014153439153439151, 0.0012239275875639514, 0.0011667760519215341, 0.0011755485893416929, 0.0009828165620442584, 0.0006827548537663241, 0.0006320095605809892, 0.0006346247725558071, 0.0005564677978471082, 0.00044390637610976593, 0.0004219592831042283, 0.00037744964821692786, 0.00030729896501708584, 0.0002842102934996572]
# plt.plot(esno, ber_2, label="ber_2")
# # plt.plot(esno, fer_2, label="fer_2")

# esno_1 = [-1, -0.95, -0.9, -0.85, -0.8, -0.75, -0.7, -0.65, -0.6, -0.55, -0.5, -0.45, -0.4, -0.35, -0.3, -0.25, -0.2, -0.15, -0.1, -0.05, 0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0, 1.05, 1.1, 1.15, 1.2, 1.25, 1.3, 1.35, 1.4, 1.45, 1.5, 1.55, 1.6, 1.65, 1.7, 1.75, 1.8, 1.85, 1.9, 1.95, 2.0, 2.05, 2.1, 2.15, 2.2, 2.25, 2.3, 2.35, 2.4, 2.45, 2.5, 2.55, 2.6, 2.65, 2.7, 2.75, 2.8, 2.85, 2.9, 2.95, 3.0, 3.05, 3.1, 3.15, 3.2, 3.25, 3.3, 3.35, 3.4, 3.45, 3.5, 3.55, 3.6, 3.65, 3.7]
# fer_1=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 1.0, 0.975609756097561, 1.0, 1.0, 0.9917355371900827, 1.0, 0.9836065573770492, 0.975609756097561, 1.0, 0.975609756097561, 0.96, 0.975609756097561, 0.9448818897637795, 0.9448818897637795, 0.9302325581395349, 0.9022556390977443, 0.8888888888888888, 0.8823529411764706, 0.851063829787234, 0.8759124087591241, 0.9022556390977443, 0.8759124087591241, 0.8633093525179856, 0.75, 0.7643312101910829, 0.75, 0.7361963190184049, 0.7228915662650602, 0.6557377049180327, 0.594059405940594, 0.5741626794258373, 0.6091370558375635, 0.5714285714285714, 0.45454545454545453, 0.46332046332046334, 0.48, 0.4166666666666667, 0.40268456375838924, 0.39087947882736157, 0.3582089552238806, 0.29925187032418954, 0.3252032520325203, 0.2863961813842482, ]
# ber_1=[0.18363095238095237, 0.18871031746031747, 0.18349206349206348, 0.18051587301587302, 0.18095238095238095, 0.17410714285714285, 0.17996031746031746, 0.17037698412698413, 0.17125, 0.17128968253968252, 0.16442460317460317, 0.1628968253968254, 0.16549603174603175, 0.1579563492063492, 0.1555952380952381, 0.1525595238095238, 0.1504563492063492, 0.15603174603174605, 0.14325396825396824, 0.14869047619047618, 0.1432936507936508, 0.13793650793650794, 0.1384920634920635, 0.13503968253968254, 0.13458333333333333, 0.12898809523809524, 0.12966269841269842, 0.12865079365079365, 0.12142857142857143, 0.11728174603174604, 0.11952380952380953, 0.10771825396825396, 0.10720238095238095, 0.11017857142857143, 0.10412698412698412, 0.09831349206349206, 0.09456349206349207, 0.09851190476190476, 0.09142857142857143, 0.08775793650793652, 0.08152777777777778, 0.0829563492063492, 0.07813492063492064, 0.07946428571428572, 0.07708333333333334, 0.07654761904761904, 0.06980158730158731, 0.07029761904761904, 0.058234126984126985, 0.06876984126984127, 0.0539484126984127, 0.049803227075954346, 0.05738095238095239, 0.05090979481223384, 0.048174603174603176, 0.046369047619047615, 0.044510035419126334, 0.039523809523809524, 0.04112021857923497, 0.03685636856368563, 0.037420634920634924, 0.03356562137049942, 0.0316, 0.03157181571815718, 0.030446194225721784, 0.026865391826021746, 0.025230712440014767, 0.022359470103831006, 0.01998236331569665, 0.019362745098039216, 0.01690307328605201, 0.016614529023288145, 0.01706050841389187, 0.0170316301703163, 0.014696813977389516, 0.01125, 0.012450712769184106, 0.011473214285714285, 0.00993280747881975, 0.009810671256454389, 0.009289617486338797, 0.006305987741631306, 0.006026429710640237, 0.006574812666183225, 0.005476190476190476, 0.004085497835497835, 0.0039713182570325425, 0.004057142857142857, 0.0036127645502645506, 0.0032278683285394696, 0.003195284628509384, 0.0025657427149964464, 0.0022622016387602423, 0.002490643954058588, 0.0021138765768837367]
# plt.plot(esno_1, ber_1, label="ber")
# # plt.plot(esno_1, fer_1, label="fer")


plt.yscale("log")  # Логарифмическая шкала по Y
plt.xlabel("EsNo [dB]")
# plt.ylabel("BER")
# plt.title("GLDPC на основе LDPC(420,364) и BCJR(15,11)")
plt.legend(
    # loc='lower right',
    # bbox_to_anchor=(0.5, -0.1),  
    # ncol=2,                
    fontsize=8,
    # frameon=False     
)
plt.grid(True, which="both", linestyle="--")
plt.savefig('modeling_results/compare.png', dpi=300, bbox_inches='tight')